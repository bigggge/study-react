{"version":3,"sources":["lib/react.js","index.js"],"names":["renderComponent","createElement","tag","attrs","children","render","vnode","container","appendChild","_render","console","log","String","document","createTextNode","component","createComponent","setComponentProps","element","dom","Object","keys","forEach","value","key","setAttribute","child","name","test","toLowerCase","style","cssText","removeAttribute","Component","props","state","stateChange","assign","inst","prototype","constructor","componentWillMount","componentWillReceiveProps","componentDidUpdate","componentWillUpdate","componentDidMount","parentNode","replaceChild","React","innerHTML","Welcome","App","Counter","num","setState","onClick","getElementById"],"mappings":"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","file":"light-react.66e7b32b.map","sourceRoot":"..","sourcesContent":["/**\n * react.js\n *\n * @author bigggge(me@haoduoyu.cc)\n * 2018/9/3.\n */\n\nfunction createElement(tag, attrs, ...children) {\n  return {\n    tag,\n    attrs,\n    children\n  };\n}\n\nfunction render(vnode, container) {\n  return container.appendChild(_render(vnode));\n}\n\nfunction _render(vnode) {\n  console.log(' [React] _render vnode', vnode);\n\n  if (typeof vnode === 'number') {\n    vnode = String(vnode);\n  }\n\n  // 渲染字符串\n  if (typeof vnode === 'string') {\n    return document.createTextNode(vnode);\n    // 渲染组件（函数）\n  }\n\n  if (typeof vnode.tag === 'function') {\n    const component = createComponent(vnode.tag, vnode.attrs);\n    setComponentProps(component, vnode.attrs);\n    return component.element;\n  }\n\n  const dom = document.createElement(vnode.tag);\n\n  if (vnode.attrs) {\n    Object.keys(vnode.attrs).forEach(key => {\n      const value = vnode.attrs[key];\n      setAttribute(dom, key, value);\n    });\n  }\n\n  if (vnode.children) {\n    vnode.children.forEach(child => render(child, dom));\n  }\n  return dom;\n}\n\nfunction setAttribute(dom, name, value) {\n  console.log(' [React] setAttribute dom,name,value', dom, name, value);\n\n  if (name === 'className') name = 'class';\n\n  if (/on\\w+/.test(name)) {\n    name = name.toLowerCase();\n    dom[name] = value || '';\n\n  } else if (name === 'style') {\n    if (!value || typeof value === 'string') {\n      dom.style.cssText = value || '';\n\n    } else if (value && typeof value === 'object') {\n      for (let name in value) {\n        dom.style[name] = typeof value[name] === 'number' ? value[name] + 'px' : value[name];\n      }\n    }\n\n  } else {\n    if (name in dom) {\n      dom[name] = value || '';\n    }\n    if (value) {\n      dom.setAttribute(name, value);\n    } else {\n      dom.removeAttribute(name, value);\n    }\n  }\n\n}\n\nclass Component {\n  constructor(props = {}) {\n    this.state = {};\n    this.props = props;\n  }\n\n  setState(stateChange) {\n    console.log(' [React] setState stateChange', stateChange);\n\n    Object.assign(this.state, stateChange);\n    // 渲染组件\n    renderComponent(this);\n  }\n}\n\n// 创建组件\nfunction createComponent(component, props) {\n  console.log(' [React] createComponent component,props', component, props);\n\n  let inst;\n  // 如果是类组件，直接返回实例\n  if (component.prototype && component.prototype.render) {\n    inst = new component(props);\n    // 如果是函数定义组件\n  } else {\n    inst = new Component(props);\n    inst.constructor = component;\n    inst.render = function() {\n      return this.constructor(props);\n    };\n  }\n  return inst;\n}\n\nfunction setComponentProps(component, props) {\n  console.log(' [React] setComponentProps component,props', component, props);\n  if (!component.element) {\n    if (component.componentWillMount) {\n      component.componentWillMount();\n    } else if (component.componentWillReceiveProps) {\n      component.componentWillReceiveProps(props);\n    }\n  }\n  component.props = props;\n  renderComponent(component);\n}\n\nexport function renderComponent(component) {\n  console.log(' [React] renderComponent component', component);\n\n  let element;\n\n  const vnode = component.render();\n  if (component.element && component.componentDidUpdate) {\n    component.componentWillUpdate();\n  }\n  element = _render(vnode);\n\n  if (component.element) {\n    if (component.componentDidMount) {\n      component.componentDidMount();\n    } else if (component.componentDidUpdate) {\n      component.componentDidUpdate();\n    }\n  }\n\n  if (component.element) {\n    component.element.parentNode.replaceChild(element, component.element);\n  }\n\n  component.element = element;\n}\n\nconst React = {\n  createElement,\n  render: (vnode, container) => {\n    container.innerHTML = '';\n    return render(vnode, container);\n  },\n  Component,\n};\n\nexport default React;\n","import React from './lib/react';\n\nfunction Welcome(props) {\n  return <h1>Hello, {props.name}</h1>;\n}\n\nfunction App() {\n  return (\n    <div>\n      <Counter />\n      <Welcome name={'peter1'} />\n      <Welcome name={'peter2'} />\n      <Welcome name={'peter3'} />\n    </div>\n  );\n}\n\nclass Counter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      num: 0\n    };\n  }\n\n  componentWillMount() {\n    console.log('mount');\n  }\n\n  componentWillUpdate() {\n    console.log('update');\n  }\n\n  onClick() {\n    this.setState({ num: this.state.num + 1 });\n  }\n\n  render() {\n    return (\n      <div onClick={() => this.onClick()}>\n        <h1>number:{this.state.num}</h1>\n        <button>add</button>\n      </div>\n    );\n  }\n\n}\n\nReact.render(\n  <App />,\n  document.getElementById('root')\n);\n// function tick() {\n//   const element = (\n//     <div>\n//       <h1 onClick={() => console.log(123)}>Hello,world!</h1>\n//       <h2 style={{ color: 'blue' }}>It is {new Date().toLocaleTimeString()}.</h2>\n//     </div>\n//   );\n//\n//   React.render(\n//     element,\n//     document.getElementById('root')\n//   );\n// }\n//\n// setInterval(tick, 10000);"]}